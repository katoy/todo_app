<!DOCTYPE html>
<html>
<head>
    <title>Todo App</title>
    <link rel="shortcut icon" href="#">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <select id="language-select" name="lang">
        <option value="en" {% if lang == 'en' %}selected{% endif %}>English</option>
        <option value="ja" {% if lang == 'ja' %}selected{% endif %}>日本語</option>
        <option value="zh" {% if lang == 'zh' %}selected{% endif %}>中文</option>
    </select>
    <h1>{{ translations['title'] if translations and translations.get('title') else 'Todo List' }}</h1>
    <p style="color: red;">{{ translations.get('errorMessage') if translations and error else error if error else '' }}</p>
    <form method="post" action="/add">
        <input type="hidden" name="lang" value="{{ lang }}">
        <input type="text" name="todo" placeholder="{{ translations['enterTodo'] if translations and translations.get('enterTodo') else 'Enter todo' }}">
        <button type="submit">{{ translations['addTodo'] if translations and translations.get('addTodo') else 'Add Todo' }}</button>
    </form>
    <table id="todo-table">
        <thead>
            <tr>
                <th>完了</th>
                <th>タスク</th>
                <th>削除</th>
            </tr>
        </thead>
        <tbody>
            {% if todos %}
                {% for todo in todos %}
                    <tr>
                        <td><input type="checkbox" data-task="{{ todo.task }}" {{ 'checked' if todo.completed else '' }} onchange="updateTodoStatus('{{ todo.task }}', this.checked)"></td>
                        <td><span class="task-name {{ 'completed' if todo.completed else 'pending' }}">{{ todo.task }}</span></td>
                        <td><a href="/delete/{{ loop.index0 }}">削除</a></td>
                    </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="3">{{ translations['noTasks'] if translations and translations.get('noTasks') else 'No tasks' }}</td>
                </tr>
            {% endif %}
        </tbody>
    </table>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
