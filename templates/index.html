<!DOCTYPE html>
<html>
<head>
    <title>Todo App</title>
    <link rel="shortcut icon" href="#">
    <select id="language-select" name="lang">
        <option value="en" {% if lang == 'en' %}selected{% endif %}>English</option>
        <option value="ja" {% if lang == 'ja' %}selected{% endif %}>日本語</option>
        <option value="zh" {% if lang == 'zh' %}selected{% endif %}>中文</option>
    </select>
    <style>
        .todo-item {
            display: flex;
            align-items: center;
        }
        .todo-item input[type="checkbox"] {
            margin-right: 10px;
        }
        .todo-item.completed {
            color: blue;
        }
        .todo-item.pending {
            color: red;
        }
    </style>
</head>
<body>
    <h1>{{ translations['title'] if translations and 'title' in translations else 'Todo List' }}</h1>
    {% if error %}
      <p style="color: red;">{{ translations['errorMessage'] if translations and 'errorMessage' in translations else error }}</p>
    {% endif %}
    <ul id="todo-list">
        {% for todo in todos %}
            <li class="todo-item {{ 'completed' if todo.completed else 'pending' }}">
                <input type="checkbox" data-task="{{ todo.task }}" {{ 'checked' if todo.completed else '' }}>
                <span class="task-name">{{ todo.task }}</span>
            </li>
        {% endfor %}
    </ul>
    <form method="post" action="/add">
        <input type="hidden" name="lang" value="{{ lang }}">
        <input type="text" name="todo">
        <button type="submit">{{ translations['addTodo'] if translations and 'addTodo' in translations else 'Add Todo' }}</button>
    </form>
    <script>
        const languageSelect = document.getElementById('language-select');
        languageSelect.addEventListener('change', function() {
            const lang = this.value;
            window.location.href = '/?lang=' + lang;
        });
    </script>
</body>
</html>
